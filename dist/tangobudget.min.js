/*! tangobudget 2019-01-17 */

function addMarkersAndAll(e,a){path=poly.getPath(),path.push(e);var n=new google.maps.Marker({position:e,label:labels[labelIndex++%labels.length],map:a,draggable:!0,animation:google.maps.Animation.DROP,title:"#"+path.getLength()});markers.push(n),poly.setMap(a),latitud.push(n.getPosition().lat()),longitud.push(n.getPosition().lng()),showCoordenadas(latitud,longitud),google.maps.event.addListener(n,"drag",function(e){if("B"==n.getLabel())path.pop(),path.push(e.latLng),path=poly.getPath(),latitud[1]=n.getPosition().lat(),longitud[1]=n.getPosition().lng();else{var a=path.removeAt(1);path.removeAt(0);path.setAt(1,a),path.setAt(0,e.latLng),path=poly.getPath(),latitud[0]=n.getPosition().lat(),longitud[0]=n.getPosition().lng()}if(flag=2,showCoordenadas(latitud,longitud),2==markers.length){var t=new google.maps.ElevationService;camino[0]=path.getAt(0),camino[1]=path.getAt(1),dist=haversine(radius,latitud,longitud),displayPathElevation(camino,t,dist)}}),n.addListener("click",toggleBounce),2==markers.length&&(elevator||(elevator=new google.maps.ElevationService),camino[0]=path.getAt(0),camino[1]=path.getAt(1),dist=haversine(radius,latitud,longitud),displayPathElevation(camino,elevator,dist))}function Bullington(e,a,t){var n,o,l,r,d,u,s;n=22/Inputfreq;var c,g,m,h,p,f,b=0,M=0;for(i=0;i<distanciaFresnel.length;i++)(-e+alturaFresnel[i])/distanciaFresnel[i]*void 0+e,o=(-e+alturaFresnel[i])/distanciaFresnel[i],r=e,Math.abs(b)<Math.abs(o)&&(b=o),s=r;for(j=0;j<distanciaFresnel.length;j++)(alturaFresnel[i]-e)/(distanciaFresnel[i]-t)*void 0+(distanciaFresnel[i]*a-t*alturaFresnel[i])/(distanciaFresnel[i]-alturaFresnel[i]),l=(alturaFresnel[i]-e)/(distanciaFresnel[i]-t),d=(distanciaFresnel[i]*a-t*alturaFresnel[i])/(distanciaFresnel[i]-alturaFresnel[i]),Math.abs(M)<Math.abs(l)&&(M=l),u=d;return OIficticio=Math.floor((s-u)/(b-M)),h_OIficticio=b*OIficticio+e,g=t-(c=100*OIficticio),m=e-OIficticio*(e-a)*.5,e==a?(p=Math.sqrt(Math.pow(c,2)+Math.pow(h_OIficticio-m,2)),f=Math.sqrt(Math.pow(g,2)+Math.pow(h_OIficticio-m,2))):(h=e<a?e:a,p=Math.sqrt(Math.pow(c,2)+Math.pow(h_OIficticio-h,2)),f=Math.sqrt(Math.pow(c,2)+Math.pow(h_OIficticio-h,2))),v=(h_OIficticio-m)*Math.sqrt(2/n*(1/p+1/f)),v<-.78?0:6.9+20*Math.log10(Math.sqrt(Math.pow(v-.1,2)+1)+v-.1)}function DispCanal(e,a){var t,n,o=document.getElementById("FactorRugosidad").value,l=document.getElementById("FactorClima").value;if("0"!=o){if(t=[0,4,1,.25][o],"0"!=l)return n=[0,1,.5,.25,.125][l],1-6*Math.pow(e,3)*t*n*Inputfreq/Math.pow(10,7+a/10);alert("Favor de completar el Factor Clima.")}else alert("Favor de completar el factor de rugosidad.")}function Fresnel(e,a,t,n){var o;if(Inputfreq){o=3*Math.pow(10,8)/Inputfreq;var l=haversine(radius,latitud,longitud);tan_alpha=(e-a)/l,alpha=Math.atan(tan_alpha);var r=100*l/2,i=altura[Math.floor(100*l/2)],d=Math.abs(r/Math.cos(alpha))/100,u=Math.abs(r/Math.cos(alpha))/100;R1=Math.sqrt(o*d*u/(d+u));var s,c,g=.6*R1,m=.4*R1;return 0==t?(s=Math.pow(100*t-r,2)/(Math.pow(g,2)+Math.pow(u,2))+Math.pow(e-i,2)/Math.pow(g,2),Math.pow(100*t-r),c=2/(Math.pow(m,2)+Math.pow(u,2))+Math.pow(e-i,2)/Math.pow(m,2)):t==l?(Math.pow(100*t-r),s=2/(Math.pow(g,2)+Math.pow(u,2))+Math.pow(a-i,2)/Math.pow(g,2),Math.pow(100*t-r),c=2/(Math.pow(m,2)+Math.pow(u,2))+Math.pow(a-i,2)/Math.pow(m,2)):(Math.pow(100*t-r),s=2/(Math.pow(g,2)+Math.pow(u,2)+Math.pow(n-i,2)/Math.pow(g,2)),Math.pow(100*t-r),c=2/(Math.pow(m,2)+Math.pow(u,2)+Math.pow(n-i,2)/Math.pow(m,2))),1<s?0:1<c&&s<1?1:2}alert("Ingrese una frecuencia")}function FSL(e,a,t){var n;n=3*Math.pow(10,8)/Inputfreq;var o=4*Math.PI*e/n;return 20*Math.log10(o)}function getFreq(){Inputfreq=parseNumber(document.getElementById("frecuencia").value),document.getElementById("frecuencia").disabled=!0;var e=parseNumber(document.getElementById("alturaantenatx").value),a=parseNumber(document.getElementById("alturaantenarx").value),t=parseFloat(e)+parseFloat(altura[0]),n=parseFloat(a)+parseFloat(altura[cant_redondeo-1]),o=0;for(i=0;i<altura.length;i++)hayDespejeCamino[i]=Fresnel(t,n,i,altura[i]),1==hayDespejeCamino[i]&&(distanciaFresnel[o]=i,alturaFresnel[o]=altura[i],o++);var l=hayDespejeCamino.filter(function(e){return 0}),r=l.filter(function(e){return 1});0==l.length?(console.log("Existe un despeje del 60% de Fresnel."),!0,diffBullington=0):0==r.length?(console.log("Existe el despeje entre el 40% y 60% del Fresnel."),!!1,diffBullington=Bullington(t,n,distancia)):(console.log("No hay despeje de Fresnel."),!1,diffBullington=0)}function InputUser(){var e,a=parseNumber(document.getElementById("gananciatx").value),t=parseNumber(document.getElementById("gananciarx").value),n=parseNumber(document.getElementById("potenciatx").value),o=100*dist,l=Math.floor(o),r=parseNumber(document.getElementById("alturaantenatx").value),i=parseNumber(document.getElementById("alturaantenarx").value),d=parseFloat(r)+parseFloat(altura[0]),u=parseFloat(i)+parseFloat(altura[l-1]),s=haversine(radius,latitud,longitud),c=parseNumber(document.getElementById("perdidasconectores").value),g=parseNumber(document.getElementById("otrasperdidas").value),m=FSL(s,d,u),h=AtenuacionLluvia(),p=(Tilt(s,d,u),a+t+n-c-m-g-h-diffBullington),v=parseFloat(document.getElementById("sensibilidadrx").value);if(!(0<=v))return v<p?30<=(e=p-v)?void(.99998<=DispCanal(s,e)?console.log("Enlace aceptable"):alert("Se debe mejorar la altura de las antenas o datos del enlace.")):void alert("Se debe mejorar la altura de las antenas o los datos del enlace."):void alert("Se debe mejorar la potencia de transmisión.");alert("La sensibilidad debe ser menor a cero")}var LOS=function(){var m=0;return function(e,a){var t=new google.visualization.DataTable;t.addColumn("string","Muestras"),t.addColumn("number","Elevacion"),t.addRow(["TX",altura[0]]);for(var n=1;n<e.length-1;n++)t.addRow(["",altura[n]]),"undefined"==t.getValue(n,1)&&(a[n]=0,altura[n]=0);t.addRow(["RX",altura[e.length-1]]);var o,l;if(0===m){var r=new google.visualization.ColumnChart(document.getElementById("elevation_chart2")),i=new google.visualization.DataView(t);i.setColumns([0,1,{calc:"stringify",sourceColumn:1,type:"string",role:"annotation"}]),r.draw(i,{height:200,legend:{position:"none"},titleY:"Perfil de elevacion (m)",titleX:"Muestras (m)",color:"yellow"}),m++}var d=altura.indexOf(data.getDistinctValues(1).filter(function(e){return!isNaN(e)})[e.length-1]);if(0!=d&&d!=e.length-1){console.log("Prueba: "+data.getDistinctValues(1)[e.length-1]);var u=data.getDistinctValues(1)[e.length-1].toFixed(3);return u>altura[e.length-1].toFixed(3)&&u>altura[0].toFixed(3)?0:altura[0].toFixed(3)<u<altura[e.length-1].toFixed(3)?(o=(altura[e.length-1].toFixed(3)-altura[0].toFixed(3))/(e.length-1-0),(u-altura[0].toFixed(3))/(d-0)<=o?(console.log("testA2"),1):0):altura[e.length-1].toFixed(3)<u<altura[0].toFixed(3)?(o=(altura[e.length-1].toFixed(3)-altura[0].toFixed(3))/(e.length-1-0),(u-altura[0].toFixed(3))/(d-0)<o?(console.log("testA3"),1):0):(console.log("testA4"),1)}if(0==d||d==e.length-1){if(0==(l=altura.indexOf(data.getDistinctValues(1)[e.length-2]))||l==e.length-1){var s=data.getDistinctValues(1)[e.length-3].toFixed(1),c=altura.indexOf(data.getDistinctValues(1)[e.length-3]);return s>altura[e.length-1].toFixed(3)&&s>altura[0].toFixed(3)?0:altura[0].toFixed(3)<s<altura[e.length-1].toFixed(3)?(o=(altura[e.length-2].toFixed(3)-altura[0].toFixed(3))/(e.length-1-0),(s-altura[0].toFixed(3))/(c-0)<=o?(console.log("testB2"),1):0):altura[e.length-1].toFixed(3)<s<altura[0].toFixed(3)?(o=(altura[e.length-1].toFixed(3)-altura[0].toFixed(3))/(e.length-1-0),(s-altura[0].toFixed(3))/(c-0)<o?(console.log("testB3"),1):0):(console.log("testB4"),1)}var g=data.getDistinctValues(1)[e.length-2].toFixed(1);return g>altura[e.length-1].toFixed(3)&&g>altura[0].toFixed(3)?0:altura[0].toFixed(3)<g<altura[e.length-1].toFixed(3)?(o=(altura[e.length-1].toFixed(3)-altura[0].toFixed(3))/(e.length-1-0),(g-altura[0].toFixed(3))/(l-0)<=o?(console.log("testB22"),1):0):altura[e.length-1].toFixed(1)<g<altura[0].toFixed(1)?(o=(altura[e.length-1].toFixed(1)-altura[0].toFixed(1))/(e.length-1-0),(g-altura[0].toFixed(1))/(l-0)<o?(console.log("testB23"),1):0):(console.log("testB24"),1)}}}();function ModifyHeight(){distanciaobject=parseNumber(document.getElementById("distanciaobjeto").value),distanciatotal=1e3*haversine(radius,latitud,longitud);var e=100*dist,a=Math.floor(e);0==Math.floor(distanciaobject)||Math.floor(distanciaobject)==a-1?alert("No se pueden colocar objetos interferentes en las antenas"):0<distanciaobject&&distanciaobject<distanciatotal&&null!=parseInt(document.getElementById("objetointerferente").value)?(flag=1,muestra_mod[++contador]=Math.floor(distanciaobject/10),displayPathElevation(camino,elevator,dist)):alert("distancia excede el largo del camino")}function ModifyRxTx(){var e=parseNumber(document.getElementById("alturaantenatx").value),a=parseNumber(document.getElementById("alturaantenarx").value);e<=0||a<=0?alert("Altura incorrecta, intente de nuevo"):(flag=4,displayPathElevation(camino,elevator,dist),document.getElementById("alturaantenarx").disabled=!0,document.getElementById("alturaantenatx").disabled=!0)}function AtenuacionLluvia(){var e,a,t=parseNumber(document.getElementById("polarizacion").value),n=haversine(radius,latitud,longitud);if(Inputfreq){var o=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,120,150,200,300,400,500,600,700,800,900,1e3],l=o.indexOf(Inputfreq);if(-1==l){for(var r=0;Inputfreq<=o[r];)r++;a=o[r],alert("Se aproximó dicho valor a"+a+"GHz para calcular la atenuación por lluvia."),l=r}var i=document.getElementById("ZonaHidrometeorologica").value,d=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q"].indexOf(i);-1==d?alert("Por favor ingresar el zona hidrometeorológica para el cálculo de lluvia."):e=[8,12,15,19,22,28,30,32,35,42,60,63,95,145,115][d];var u,s;if(1==t)u=[308e-7,574e-7,998e-7,146e-6,194e-6,235e-6,246e-6,235e-6,243e-6,312e-6,488e-6,.001425,.00345,.006691,.01129,.01731,.02455,.03266,.04126,.05008,.05899,.06797,.07708,.08642,.09611,.1063,.117,.1284,.1404,.1533,.1669,.1813,.1964,.2124,.2291,.2465,.2646,.2833,.3026,.3224,.3427,.3633,.3844,.4058,.4274,.4492,.4712,.4932,.5153,.5375,.5596,.5817,.6037,.6255,.6472,.6687,.6901,.7112,.7321,.7527,.773,.7931,.8129,.8324,.8515,.8704,.8889,.9071,.925,.9425,.9598,.9767,.9932,1.0094,1.0253,1.0409,1.0561,1.0711,1.0857,1.1,1.1139,1.1276,1.141,1.1541,1.1668,1.1793,1.1915,1.2034,1.2151,1.2265,1.2376,1.2484,1.259,1.2694,1.2795,1.2893,1.2989,1.3083,1.3175,1.3265,1.3352,1.3437,1.352,1.3601,1.368,1.4911,1.5896,1.6443,1.6286,1.582,1.5366,1.4967,1.4622,1.4321,1.4056,1.3822][l],s=[.8592,.8957,.949,1.0085,1.0688,1.1387,1.2476,1.3987,1.5317,1.5882,1.5728,1.4745,1.3797,1.2895,1.2156,1.1617,1.1216,1.0901,1.0646,1.044,1.0273,1.0137,1.0025,.993,.9847,.9771,.97,.963,.9561,.9491,.9421,.9349,.9277,.9203,.9129,.9055,.8981,.8907,.8834,.8761,.869,.8621,.8552,.8486,.8421,.8357,.8296,.8236,.8179,.8123,.8069,.8017,.7967,.7918,.7871,.7826,.7783,.7741,.77,.7661,.7623,.7587,.7552,.7518,.7486,.7454,.7424,.7395,.7366,.7339,.7313,.7287,.7262,.7238,.7215,.7193,.7171,.715,.713,.711,.7091,.7073,.7055,.7038,.7021,.7004,.6988,.6973,.6958,.6943,.6929,.6915,.6902,.6889,.6876,.6864,.6852,.684,.6828,.6817,.6806,.6796,.6785,.6775,.6765,.6609,.6466,.6343,.6262,.6256,.6272,.6293,.6315,.6334,.6351,.6365][l];else{if(2!=t)return void alert("Ingrese un tipo de polarización");u=[259e-7,443e-7,847e-7,132e-6,139e-6,116e-6,107e-6,134e-6,216e-6,391e-6,706e-6,.001915,.004115,.007535,.01217,.01772,.02386,.03041,.03738,.04481,.05282,.06146,.07078,.08084,.09164,.1032,.1155,.1286,.1425,.1571,.1724,.1884,.2051,.2224,.2403,.2588,.2778,.2972,.3171,.3374,.358,.3789,.4001,.4215,.4431,.4647,.4865,.5084,.5302,.5521,.5738,.5956,.6172,.6386,.66,.6811,.702,.7228,.7433,.7635,.7835,.8032,.8226,.8418,.8606,.8791,.8974,.9153,.9328,.9501,.967,.9836,.9999,1.0159,1.0315,1.0468,1.0618,1.0764,1.0908,1.1048,1.1185,1.132,1.1451,1.1579,1.1704,1.1827,1.1946,1.2063,1.2177,1.2289,1.2398,1.2504,1.2607,1.2708,1.2807,1.2903,1.2997,1.3089,1.3179,1.3266,1.3351,1.3434,1.3515,1.3594,1.3671,1.4866,1.5823,1.6378,1.6286,1.586,1.5418,1.5013,1.4654,1.4335,1.405,1.3795][l],s=[.9691,1.0185,1.0664,1.1209,1.2322,1.4189,1.6009,1.6948,1.6969,1.6499,1.59,1.481,1.3905,1.3155,1.2571,1.214,1.1825,1.1586,1.1396,1.1233,1.1086,1.0949,1.0818,1.0691,1.0568,1.0447,1.0329,1.0214,1.0101,.9991,.9884,.978,.9679,.958,.9485,.9392,.9302,.9214,.9129,.9047,.8967,.889,.8816,.8743,.8673,.8605,.8539,.8476,.8414,.8355,.8297,.8241,.8187,.8134,.8084,.8034,.7987,.7941,.7896,.7853,.7811,.7771,.7731,.7693,.7656,.7621,.7586,.7552,.752,.7488,.7458,.7428,.74,.7372,.7345,.7318,.7293,.7268,.7244,.7221,.7199,.7177,.7156,.7135,.7115,.7096,.7077,.7058,.704,.7023,.7006,.699,.6974,.6959,.6944,.6929,.6915,.6901,.6888,.6875,.6862,.685,.6838,.6826,.6815,.664,.6494,.6382,.6296,.6262,.6253,.6262,.6284,.6315,.6353,.6396][l]}console.log("k:"+u),console.log("alfa:"+s);var c=u*Math.pow(e,s),g=(Math.exp(-.015*e),c*(n*(1/(.477*Math.pow(n,.633)*Math.pow(e,.073*s)*Math.pow(a,.123)-10.579*(1-Math.exp(-.024*n))))));return console.log("Las pérdidas debido a lluvias son de: "+g+"dB."),g}alert("Ingrese una frecuencia")}function Resultados(e,a,t,n,o,l){google.charts.load("current",{packages:["table"]}),google.charts.setOnLoadCallback(function(){data_resultados||((data_resultados=new google.visualization.DataTable).addColumn("boolean","Hay linea de vista?"),data_resultados.addColumn("number","Perdidas de espacio libre (dB)"),data_resultados.addColumn("number","Disponibilidad del canal (%)"),data_resultados.addColumn("number","Angulo de Tilt"),data_resultados.addColumn("boolean","Despeje 60%?"),data_resultados.addColumn("boolean","Despeje 40%?"),tableRes=new google.visualization.Table(document.getElementById("result_table")));data_resultados.addRow([e,+a,+t,+n,o,l]),tableRes.draw(data_resultados,{showRowNumber:!1,width:"100%",height:"100%"})})}function AgregarTabla(t,e,n){google.charts.load("current",{packages:["table"]}),google.charts.setOnLoadCallback(function(){data_detabla||((data_detabla=new google.visualization.DataTable).addColumn("string","Tipo"),data_detabla.addColumn("number","Distancia desde el Tx (m)"),data_detabla.addColumn("number","Altura (m)"),data_detabla.addColumn("boolean","Despeje 60%?"),data_detabla.addColumn("boolean","Despeje 40%?"),data_detabla.addColumn("number","Muestra Modificada"),table=new google.visualization.Table(document.getElementById("table_div")));var e,a;a=0==n?e=!0:1==n?!(e=!1):e=!1;data_detabla.addRow([t,+parseFloat(document.getElementById("distanciaobjeto").value),+parseFloat(document.getElementById("alturaobjeto").value),e,a,+muestra_mod[contador]]),table.draw(data_detabla,{showRowNumber:!0,width:"100%",height:"100%"}),document.getElementById("alturaobjeto").value="",document.getElementById("distanciaobjeto").value=""})}function BorrarFila(){data_detabla.removeRow(contador-1),table.draw(data_detabla,{showRowNumber:!0,width:"100%",height:"100%"})}function Tilt(e,a,t){return toDegrees(Math.atan((a-t)/e))}function DeshacerAltura(){return 0<=contador?(flag=3,void displayPathElevation(camino,elevator,dist)):void alert("Ya se deshicieron todos los cambios.")}function DistanceToBorders(e,a){lat[0]=e[a].lat(),lng[0]=e[a].lng(),lat[1]=e[255].lat(),lng[1]=e[255].lng();var t=haversine(radius,lat,lng);console.log("Distancia a RX"+t.toFixed(6)+" km"),lat[1]=e[0].lat(),lng[1]=e[0].lng();haversine(radius,lat,lng);console.log("Distancia a TX"+t.toFixed(6)+" km")}function dragElement(a){var t=0,n=0,o=0,l=0;function e(e){(e=e||window.event).preventDefault(),o=e.clientX,l=e.clientY,document.onmouseup=i,document.onmousemove=r}function r(e){(e=e||window.event).preventDefault(),t=o-e.clientX,n=l-e.clientY,o=e.clientX,l=e.clientY,a.style.top=a.offsetTop-n+"px",a.style.left=a.offsetLeft-t+"px"}function i(){document.onmouseup=null,document.onmousemove=null}document.getElementById(a.id+"Header")?document.getElementById(a.id+"Header").onmousedown=e:a.onmousedown=e}function displayPathElevation(e,a,t){var n=100*t;cant_redondeo=Math.floor(n),console.log("Cantidad de muestras por km: "+n),console.log("Redondeo de muestras: "+cant_redondeo),a.getElevationAlongPath({path:e,samples:cant_redondeo},plotElevation)}function plotElevation(e,a){var t=document.getElementById("elevation_chart");if("OK"===a){if(!data||2==flag){data=new google.visualization.DataTable,chart=new google.visualization.ColumnChart(t),data.addColumn("string","Sample"),data.addColumn("number","Elevation");for(var n=0;n<e.length;n++){if(data.addRow(["",e[n].elevation]),"undefined"==data.getValue(n,1)&&(coordenadas[n]=NaN,altura[n]=NaN),altura.filter(function(e){return e!=isNaN}).length/altura.length<.8)return void alert("Vuelva a recargar la página, hay pérdida de información en el perfil de elevación.");altura[n]=data.getValue(n,1),coordenadas[n]=e[n].location}flag=0}if(0==flag)h_Pmax1=data.getDistinctValues(1)[e.length-1],h_Pmax2=data.getDistinctValues(1)[e.length-2],Pmax1=altura.indexOf(h_Pmax1),Pmax2=altura.indexOf(h_Pmax2);else if(1==flag){var o=parseFloat(altura[muestra_mod[contador]])+parseFloat(document.getElementById("alturaobjeto").value),l=document.getElementById("distanciaobjeto").value;if(muestra_mod[contador]=Math.floor(l/10),0==muestra_mod[contador]||muestra_mod[contador]==cant_redondeo-1)return void alert("No se pueden colocar objetos interferentes en las antenas, corrija las distancias");if(valuetomodify_array[contador]=parseFloat(document.getElementById("alturaobjeto").value),distanciaobject_array[contador]=parseFloat(document.getElementById("distanciaobjeto").value),data.setValue(muestra_mod[contador],1,o),objInterferente=document.getElementById("objetointerferente").value,!objInterferente)return alert("Ingrese un tipo de interferencia"),void(flag=0);"arbol"==objInterferente?objInterferente="Arbol":"edificio"==objInterferente&&(objInterferente="Edificio");var r=Fresnel(document.getElementById("frecuencia").value,parseFloat(document.getElementById("alturaantenatx").value),parseFloat(document.getElementById("alturaantenarx").value)+altura[cant_redondeo-1],distanciaobject_array[contador],valuetomodify_array[contador]);document.getElementById("frecuencia").value,parseFloat(document.getElementById("alturaantenatx").value),altura[0],parseFloat(document.getElementById("alturaantenarx").value),altura[cant_redondeo-1],distanciaobject_array[contador],resFresnel=valuetomodify_array[contador],AgregarTabla(objInterferente,+resFresnel,+r),flag=0}else 3==flag?(data.setValue(muestra_mod[contador],1,altura[muestra_mod[contador]]),BorrarFila(),contador--,flag=0):4==flag&&(data.setValue(0,1,parseFloat(document.getElementById("alturaantenatx").value)+altura[0]),data.setValue(cant_redondeo-1,1,parseFloat(document.getElementById("alturaantenarx").value)+altura[cant_redondeo-1]),altura[0]=altura[0]+parseFloat(document.getElementById("alturaantenatx").value),altura[cant_redondeo-1]=altura[cant_redondeo-1]+parseFloat(document.getElementById("alturaantenarx").value),flag=0);chart.draw(data,{height:200,legend:"none",titleX:"Cantidad de muestras",titleY:"Elevation (m)"}),1==(hayLOS=LOS(e,coordenadas))?document.getElementById("Ldevista").innerHTML="¡Hay línea de vista!":0==hayLOS&&(document.getElementById("Ldevista").innerHTML="¡Cuidado! No hay línea de vista. Se sugiere aumentar las alturas de las antenas.")}else t.innerHTML="No se pudo calcular el perfil de elevación porque: "+a}function showCoordenadas(e,a){for(var t=0;t<markers.length;t++)document.getElementById("transmisor").value=e[0]+", "+a[0],document.getElementById("receptor").value=e[1]+", "+a[1];if(0!==e[0]&&0!==e[1]){var n=haversine(radius,e,a);document.getElementById("result3").innerHTML=n.toFixed(6)+" km"}}function deleteMarkersAndPath(){markers[0].setMap(null),markers[1].setMap(null),markers=[],latitud=[],longitud=[],camino=[],elevator=[],elevations=[],altura=[],contador=data=0,path=poly.setPath([]),document.getElementById("transmisor").value="",document.getElementById("receptor").value="",document.getElementById("result3").innerHTML="",document.getElementById("Ldevista").innerHTML="",document.getElementById("elevation_chart").innerHTML="",document.getElementById("elevation_chart2").innerHTML=""}dragElement(document.getElementById("Boton"));var data,chart,elevator,dist,cant_redondeo,Pmax1,h_Pmax1,elevations,data_detabla,data_resultados,table,tableRes,hayLOS,resFresnel,Inputfreq,diffBullington,labels="TR",labelIndex=0,markers=[],latitud=[],longitud=[],radius=6371,camino=[],altura=[],coordenadas=[],posic_puntoMax=0,valor_puntoMax=0,flag=0,muestra_mod=[],distanciaobject_array=[],contador=0,valuetomodify_array=[],distanciaFresnel=[],alturaFresnel=[],hayDespejeCamino=[],APP={};function initMap(){var a=new google.maps.Map(document.getElementById("map"),{zoom:15,center:{lat:-34.916467,lng:-56.154272}});google.maps.event.addListener(a,"click",function(e){markers.length<=1&&addMarkersAndAll(e.latLng,a)}),poly=new google.maps.Polyline({strokeColor:"#000000",strokeOpacity:1,strokeWeight:3})}function haversine(e,a,t){var n=ToRadians(a[0]),o=ToRadians(t[0]),l=ToRadians(a[1]),r=n-l,i=o-ToRadians(t[1]),d=Math.sin(r/2),u=Math.sin(i/2),s=Math.pow(d,2)+Math.cos(n)*Math.cos(l)*Math.pow(u,2);return 2*e*Math.asin(Math.min(1,Math.sqrt(s)))}function toggleBounce(){marker.setAnimation(google.maps.Animation.BOUNCE)}function printPDF(){var e=new jsPDF;e.fromHTML($("#panel-total").get(0),20,20,{width:500}),e.save("Reporte.pdf")}function toDegrees(e){return 180*e/Math.PI}function parseNumber(e){var a=/^[+-]?(\d+)(?:[,.](\d+))?$/.exec(e);return a?a[2]?+(a[1]+"."+a[2]):+a[1]:NaN}function ToRadians(e){return e*(Math.PI/180)}APP.objInterferente=null,APP.prueba=[],google.load("visualization","1",{packages:["columnchart"]});